# cliapp: General Purpose Go CLI App Template

This project is a template for building general purpose cross-platform Go CLI tools using Cobra, Docker, and modern automation. **No application binary or source is shipped in this repository**—instead, you get automation (Makefile, Docker, CI) to rapidly scaffold, build, and test your own CLI app.

## Features
- **Cobra-based CLI**: Standard Go CLI layout under `cmd/` (created by automation).
- **Docker & DevContainer**: Develop in a reproducible container with all tools preinstalled.
- **CI/CD**: GitHub Actions for build, test, lint, and CodeQL security scanning.
- **Makefile**: Common tasks automated (build, test, lint, format, clean, scaffold).
- **AI-Ready**: Optimized for use with GitHub Copilot and other AI tools.

## Quick Start

### 1. Scaffold and Build Your App
```bash
make newapp APPNAME=myapp   # Scaffold a new CLI app named 'myapp'
make build APPNAME=myapp    # Build the app (outputs to bin/myapp)
./bin/myapp --help          # Run your new CLI app
```

### 2. Add Your Commands
- Use `cobra-cli add <command>` to scaffold new commands in `cmd/` (after initial generation).
- Edit `cmd/root.go` to customize the app.

### 3. Remove Your App
```bash
make removeapp APPNAME=myapp   # Remove the app source and binary
```

This command deletes both the app’s source directory (e.g., `myapp/`) and its binary (e.g., `bin/myapp`).

## Project Structure (after running `make newapp APPNAME=myapp` and `make build APPNAME=myapp`)
```
myapp/
  main.go
  cmd/
bin/
  myapp
```

> **Note:** The app source directory (e.g., `myapp/`) and binary (e.g., `bin/myapp`) are generated by automation and are not tracked in git. See `.gitignore`.

## CI/CD
- On push/PR: Build, test, lint (see `.github/workflows/ci.yml`).
- CodeQL security scan (see `.github/workflows/codeql.yml`).

## VS Code Workspaces

This project works well as a single-folder workspace in VS Code. Simply open the project folder in VS Code to get started.

**Why use a VS Code workspace?**
- Save project-specific settings (formatting, linting, etc.)
- Share recommended extensions and tasks with your team
- Organize multi-folder or monorepo projects

**How to use:**
- Open the project folder in VS Code: `File > Open Folder...`
- (Optional) To create a multi-root workspace or save workspace settings, go to `File > Save Workspace As...` and save a `.code-workspace` file in the project root.
- You can add project-specific settings in `.vscode/settings.json` and recommend extensions in `.vscode/extensions.json`.

For most users, simply opening the project folder is enough. For advanced configuration, see the [VS Code documentation on workspaces](https://code.visualstudio.com/docs/editor/workspaces).

## Enhancements

### Add go.mod to New Apps
To automatically create a `go.mod` file for each new app, update the `newapp` target in your Makefile to include:
```makefile
	cd $(APPNAME) && go mod init $(APPNAME)
```
This will initialize a Go module for the new app.

### Integrate Cobra (Optional)
To scaffold a Cobra-based CLI, install `cobra-cli` in your dev container and add to the `newapp` target:
```makefile
	cd $(APPNAME) && cobra-cli init --pkg-name $(APPNAME)
```
This will set up a standard Cobra CLI structure.

### Example Test Target
You can add example tests to the scaffolded app and ensure the `test` target works. For example, in your `newapp` target, add:
```makefile
	mkdir -p $(APPNAME)/cmd
	echo 'package main\n\nimport "testing"\n\nfunc TestMain(t *testing.T) {\n    // Example test\n}' > $(APPNAME)/main_test.go
```

### Usage Example
```bash
make newapp APPNAME=demo         # Scaffold new app with go.mod and optional Cobra
make build APPNAME=demo          # Build the app
make test APPNAME=demo           # Run tests
make removeapp APPNAME=demo      # Remove the app and its binary
```

### .gitignore
Ensure your `.gitignore` includes patterns to ignore all generated app directories and binaries:
```
/bin/
*
!README.md
!Makefile
!Dockerfile
!bin/
```
Adjust as needed to avoid tracking generated content.

**Tip:** For AI-assisted development, use GitHub Copilot or similar tools to accelerate feature development, generate tests, and improve code quality. See `guidelines/github-copilot-best-practices.md` for tips.

---
